
## 8장. 데이터베이스 설계

### 1. 데이터베이스 설계

데이터베이스를 설계한다는 것은 데이터베이스의 스키마 내에 테이블, 인덱스, 뷰 등의 데이터베이스의 객체를 정의하는 것을 의미한다.
데이터베이스 설계의 주된 내용은 테이블의 이름이나 열, 자료형 등을 결정하는 것을 말한다.

- 논리명과 물리명

보통 테이블의 정의서는 아래 그림 처럼, DESC 명령을 그대로 옮겨 적은 것이라 해도 무방함.

<div align="center">
    <img src="https://user-images.githubusercontent.com/97272787/226761161-66213a22-655e-4c19-92d1-c572b4c7e3bf.png">
</div>

테이블을 설계할 때는 테이블의 이름이나 열 이름을 지정하는데, 하나의 테이블에 대해 두 개의 이름을 지정할 때도 있다.
하나는 실제 데이터베이스 사용할 CREATE TABLE에 지정하는 `물리명` 이다.
나머지 하나는 `논리명` 이라는 테이블의 '설계상' 이름이다.

자료형에서는 데이터에 따라 `CHECK` 제약조건을 걸어 1, 2, 3 중에 하나라던가 `YES, NO`중에 하나만 데이터의 제약을 걸어서 자료형을 만들 때도 있다.
그리고 `CHECK`를 걸때는 제안서에 이런 항목을 반드시 설명해야 한다.

- 고정길이와 가변길이

데이터베이스에서 VARCHAR가 길이가 모자라면 `LOB`을 쓴다 `LOB`은 크기가 크지만 인덱스를 지정할 수 없다는 단점이 있다.

- 기본키

MySQL에서는 `AUTO_INCREMENT`로 자동증가 열을 지정한다. `AUT0_INCREMENT`를 쓸때는 다른 제약조건을 위반할 수 있으므로 반드시 PK 또는 UNIQUE로 작성해야한다.

### 35강. 정규화

정규화란 데이터베이스의 테이블을 규정된 올바른 형태로 개선나가는 것이다.

- 제 1정규형

RDB의 테이블에서는 하나의 셀에 하나의 값만 저장할 수 있다는 제약이 있다. 이러한 부분을 개선해 나가는 게 `제 1정규화`이다.

제 1정규화에서는 중복을 제거하는 테이블의 분할을 제거하는 과정도 포함되어 있다.

또한, 기본키 지정또한 이루어진다.


<div align="center">
    <img src="https://user-images.githubusercontent.com/97272787/226762684-3f39b2f5-936b-4685-909e-811e5ea75828.png">
</div>

- 제 2정규형

완전 함수 종속성을 제거하는 것이 `제 2정규화`이다! 함수의 종속성이란 키 값을 이용해 데이터를 특정 지을 수 있는 것이다.

<div align="center">
    <img src="https://user-images.githubusercontent.com/97272787/226762905-e12093cb-9b0e-4ce8-8a6a-52c57f518d68.png">
</div>

- 제 3정규형

제 2정규화 까지는 기본키의 중복이 없는지 검사했지만, 제 3정규화에선 기본키 이외의 부분에서 중복이 없는지를 검사한다.
이행점 함수종속을 제거하는 것이 `제 3정규화`이다!

<div align="center">
    <img src="https://user-images.githubusercontent.com/97272787/226763219-191b5f56-e7dd-44e5-8939-317e07643740.png">
</div>

### 36강. 트랜잭션

```sql
START TRANSACTION
COMMIT
ROLLBACK
```

1. 트랜잭션

트랜잭션을 사용해서 데이터를 추가하면 `롤백`을 할 수 있다. 에러가 없으면 `커밋`을 하면된다.

AUTO COMMIT이 되어있는 경우가 많은데 이를 종료하기 위해서 `START TRANSACTION`을 사용하자.

```sql
START TRANSACTION

INSERT INTO 주문 VALUES(4, '2021-01-01', 1);
INSERT INTO 주문상품 VALUES(4, '0003', 1);
INSERT INTO 주문상품 VALUES(4, '0004', 1);

COMMIT;
```

세트로 실행하고 싶은 SQL명령은 트랜잭션으로 묶어서 사용하자
